import{_ as S,m as k,f as $,r as n,o as r,c as d,b as a,d as e,w as f,F as b,B as x,C as E,t as p,a as w,g as i,G as u,D as B,H as C}from"./index-ace94a49.js";import{c as g}from"./cartStore-0a4bf2bb.js";import{P as I}from"./PageBanner-f0cb60a0.js";import"./sweetalert2.all-15143214.js";const{VITE_URL:F,VITE_PATH:L}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"kc777",BASE_URL:"/Burger/",MODE:"production",DEV:!1,PROD:!0},U={data(){return{pageTitle:{title:"購物車結帳"}}},components:{PageBanner:I},computed:{...k(g,["carts","total","final_total","data"])},methods:{...$(g,["getCart"]),onSubmit(){const s=this.data;this.$refs.form.resetForm(),this.$http.post(`${F}api/${L}/order`,{data:s}).then(t=>{const _=t.data.orderId;this.$router.push(`/pay/${_}`),this.$swal({title:"建立訂單成功",icon:"success",showConfirmButton:!1}),this.$refs.form.resetForm(),this.getCart()}).catch(t=>{this.$swal({title:"建立訂單錯誤",icon:"error",showConfirmButton:!1})})},phone(s){return/^(09)[0-9]{8}$/.test(s)?!0:"需要正確的電話號碼"}},mounted(){this.getCart()}},N={id:"page-content",class:"container"},P={key:0,class:"text-center"},D=e("p",{class:"h2 mb-3"},"購物車內還沒有商品，請先點餐！",-1),R={key:1},q=w('<ul class="cartStep"><li class="stepItem"><p>Step <span class="numText">1</span></p><p>確認訂單</p></li><li class="stepItem active"><p>Step <span class="numText">2</span></p><p>填寫資料</p></li><li class="stepItem"><p>Step <span class="numText">3</span></p><p>訂單結帳</p></li><li class="stepItem"><p>Step <span class="numText">4</span></p><p>完成訂購</p></li></ul>',1),A={class:"product-pay"},M={class:"row"},z={class:"col-lg-5"},H={class:"order-detail p-2"},O=e("div",{class:"block-title"}," 購物車明細 ",-1),W={class:"table align-middle text-center"},G=e("thead",null,[e("tr",{class:"bg-secondary text-white"},[e("th",null,"品名"),e("th",null,"數量"),e("th",null,"單價")])],-1),j={class:"text-start"},J={class:"text-danger"},K=e("td",{colspan:"2",class:"text-end"},"總計",-1),Q={class:"text-end"},X={class:"col-lg-7"},Y={class:"p-2"},Z=e("div",{class:"block-title"},"訂購人資訊",-1),ee={class:"mb-3"},se=e("label",{for:"name",class:"form-label"},[e("span",{class:"text-danger me-1"},"*"),i("訂購人姓名")],-1),te={class:"mb-3"},ae=e("label",{for:"tel",class:"form-label"},[e("span",{class:"text-danger me-1"},"*"),i("訂購人手機")],-1),le={class:"mb-3"},oe=e("label",{for:"email",class:"form-label"},[e("span",{class:"text-danger me-1"},"*"),i("Email")],-1),ne={class:"mb-3"},re=e("label",{for:"address",class:"form-label"},[e("span",{class:"text-danger me-1"},"*"),i("訂購人地址")],-1),de={class:"mb-3"},ie=e("label",{for:"message",class:"form-label"},"留言",-1),ce=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-primary"},"送出訂單")],-1);function me(s,t,_,pe,v,h){const V=n("PageBanner"),T=n("RouterLink"),c=n("VField"),m=n("ErrorMessage"),y=n("VForm");return r(),d(b,null,[a(V,{pageTitle:v.pageTitle},null,8,["pageTitle"]),e("section",N,[s.total==0?(r(),d("div",P,[D,a(T,{to:"/order",class:"btn btn-primary mt-5"},{default:f(()=>[i("立即點餐")]),_:1})])):(r(),d("div",R,[q,e("div",A,[e("div",M,[e("div",z,[e("div",H,[O,e("table",W,[G,e("tbody",null,[s.carts?(r(!0),d(b,{key:0},x(s.carts,l=>(r(),d("tr",{key:l.id},[e("td",j,p(l.product.title),1),e("td",null,[e("div",null,p(l.qty),1)]),e("td",null," $ "+p(l.total.toLocaleString("zh-TW")),1)]))),128)):E("",!0)]),e("tfoot",null,[e("tr",J,[K,e("td",Q,"$ "+p(s.total.toLocaleString("zh-TW")),1)])])])])]),e("div",X,[e("div",Y,[Z,a(y,{ref:"form",class:"order-form",onSubmit:h.onSubmit},{default:f(({errors:l})=>[e("div",ee,[se,a(c,{id:"name",name:"姓名",type:"text",class:u(["form-control",{"is-invalid":l.姓名}]),placeholder:"請輸入姓名",modelValue:s.data.user.name,"onUpdate:modelValue":t[0]||(t[0]=o=>s.data.user.name=o),rules:"required"},null,8,["class","modelValue"]),a(m,{name:"姓名",class:"invalid-feedback"})]),e("div",te,[ae,a(c,{id:"tel",name:"電話",type:"tel",class:u(["form-control",{"is-invalid":l.電話}]),placeholder:"請輸入手機號碼",modelValue:s.data.user.tel,"onUpdate:modelValue":t[1]||(t[1]=o=>s.data.user.tel=o),rules:h.phone},null,8,["class","modelValue","rules"]),a(m,{name:"電話",class:"invalid-feedback"})]),e("div",le,[oe,a(c,{id:"email",name:"email",type:"email",class:u(["form-control",{"is-invalid":l.email}]),modelValue:s.data.user.email,"onUpdate:modelValue":t[2]||(t[2]=o=>s.data.user.email=o),placeholder:"請輸入 Email",rules:"required|email"},null,8,["class","modelValue"]),a(m,{name:"email",class:"invalid-feedback"})]),e("div",ne,[re,a(c,{id:"address",name:"地址",type:"text",class:u(["form-control",{"is-invalid":l.地址}]),placeholder:"請輸入地址",modelValue:s.data.user.address,"onUpdate:modelValue":t[3]||(t[3]=o=>s.data.user.address=o),rules:"required"},null,8,["class","modelValue"]),a(m,{name:"地址",class:"invalid-feedback"})]),e("div",de,[ie,B(e("textarea",{id:"message",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=o=>s.data.message=o),cols:"30",rows:"10"},null,512),[[C,s.data.message]])]),ce]),_:1},8,["onSubmit"])])])])])]))])],64)}const be=S(U,[["render",me]]);export{be as default};
