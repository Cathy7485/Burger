import{h as P,i as $,_ as g,o as l,c as i,d as t,t as a,m as w,f as v,M as _,r as u,F as m,B as D,b as p}from"./index-920fa7f4.js";import{d as E,p as T}from"./productPagination-63cf663a.js";const{VITE_URL:V,VITE_PATH:y}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"kc777",BASE_URL:"/Burger/",MODE:"production",DEV:!1,PROD:!0},h=P("orderStore",{state:()=>({ordersData:[],pagination:{}}),actions:{getOrders(e=1){const o=`${V}api/${y}/admin/orders/?page=${e}`;$.get(o).then(s=>{this.ordersData=s.data.orders,this.pagination=s.data.pagination}).catch(s=>{swal.fire({icon:"error",title:`${s.response.data.message}`,showConfirmButton:!1})})},createDate(e){const o=new Date(e*1e3),s=o.getFullYear(),c=o.getMonth()+1>=10?o.getMonth()+1:`0${o.getMonth()+1}`,n=o.getDate()>=10?o.getDate():`0${o.getDate()}`;return`${s}/${c}/${n}`}},getters:{orders:({ordersData:e})=>e,pages:({pagination:e})=>e}}),O={props:["tempProduct"]},k={class:"modal-dialog"},B={class:"modal-content border-0"},C=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"訂單內容")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),I={class:"modal-body"},L={class:"mb-2 p-1"},A={class:"mb-2 p-1"},R={class:"mb-2 p-1"},S={class:"mb-2 p-1"},U=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 關閉 ")],-1);function x(e,o,s,c,n,r){return l(),i("div",k,[t("div",B,[C,t("div",I,[t("div",L,"訂單編號："+a(s.tempProduct.id),1),t("div",A,"訂單日期："+a(s.tempProduct.create_at),1),t("div",R,"總金額："+a(s.tempProduct.total),1),t("div",S,"訂單狀態："+a(s.tempProduct.is_paid?"已付款":"未付款"),1)]),U])])}const H=g(O,[["render",x]]),{VITE_URL:F,VITE_PATH:N}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"kc777",BASE_URL:"/Burger/",MODE:"production",DEV:!1,PROD:!0},Y={data(){return{tempProduct:{imagesUrl:[]},page:{}}},components:{orderStore:h,orderModal:H,deleteModal:E,productPagination:T},computed:{...w(h,["orders","pages"])},methods:{...v(h,["getOrders"]),deleteProduct(){const e=`${F}api/${N}/admin/order/${this.tempProduct.id}`;this.$http.delete(e).then(()=>{this.getOrders(),this.deleteModal.hide(),this.$swal({title:"刪除成功！",icon:"success",showConfirmButton:!1})}).catch(o=>{this.$swal({title:o.response.data.message,icon:"error",showConfirmButton:!1})})},openModal(e,o){e==="check"?(this.orderModal.show(),this.tempProduct={...o}):e==="del"&&(this.deleteModal.show(),this.tempOrder={...o})},switchDate(e){return new Date(e*1e3).toISOString().slice(0,10)}},mounted(){this.getOrders(),this.orderModal=new _("#orderModal"),this.deleteModal=new _("#deleteModal")}},j={class:"main container"},q={class:"table mt-4"},z=t("thead",null,[t("tr",null,[t("th",{width:"120"},"訂單日期"),t("th",null,"訂單編號"),t("th",{width:"120"},"訂購人"),t("th",{width:"120"}),t("th",{width:"100"},"狀態"),t("th",{width:"120"},"編輯")])],-1),G={class:""},J={class:"text-success"},K={class:"btn-group"},Q=["onClick"],W=["onClick"],X={id:"orderModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},Z={id:"deleteModal",ref:"deleteModal",class:"modal fade",tabindex:"-1","aria-labelledby":"deleteModalLabel","aria-hidden":"true"};function tt(e,o,s,c,n,r){const b=u("productPagination"),f=u("order-modal"),M=u("delete-modal");return l(),i(m,null,[t("div",j,[t("table",q,[z,(l(!0),i(m,null,D(e.orders,d=>(l(),i("tbody",{key:d.id},[t("tr",null,[t("td",null,[t("span",G,a(r.switchDate(d.create_at)),1)]),t("td",null,a(d.id),1),t("td",null,a(d.user.name),1),t("td",null,a(d.user.cartTotal),1),t("td",null,[t("span",J,a(d.is_paid?"已付款":"未付款"),1)]),t("td",null,[t("div",K,[t("button",{type:"button",id:"viewBtn",class:"btn btn-outline-secondary btn-sm",onClick:()=>r.openModal("check",d)}," 檢視 ",8,Q),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:()=>r.openModal("del",d)}," 刪除 ",8,W)])])])]))),128))]),p(b,{pages:e.pages,"get-data":e.getOrders,onChangePage:e.getOrders},null,8,["pages","get-data","onChangePage"])]),t("div",X,[p(f,{"temp-product":n.tempProduct,"update-product":e.updateProduct},null,8,["temp-product","update-product"])],512),t("div",Z,[p(M,{"temp-product":n.tempProduct,"delete-product":r.deleteProduct},null,8,["temp-product","delete-product"])],512)],64)}const st=g(Y,[["render",tt]]);export{st as default};
