import{_ as y,o as a,c,a as t,t as m,D as d,H as n,F as b,B as w,C as x,K as k,M as v,r as g,b as f}from"./index-178f8266.js";import{d as C,p as V}from"./productPagination-e5195482.js";const B={props:["tempProduct","updateProduct","isNew"],data(){return{product:{}}},methods:{},watch:{tempProduct(){this.product=this.tempProduct}}},N={id:"product-modal-template"},D={class:"modal-dialog modal-xl"},E={class:"modal-content border-0"},L={class:"modal-header bg-dark text-white"},T={id:"productModalLabel",class:"modal-title"},A=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),I={class:"modal-body"},R={class:"row"},H={class:"col-sm-4"},F={class:"mb-2"},O={class:"mb-2"},S=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),$=["src"],K=t("h4",null,"多圖設置",-1),j={key:0},q=["onUpdate:modelValue"],z=["src","alt"],G={class:"col-sm-8"},J={class:"mb-3"},Q=t("label",{for:"title",class:"form-label"},"標題",-1),W={class:"row"},X={class:"mb-3 col-md-6"},Y=t("label",{for:"category",class:"form-label"},"分類",-1),Z={class:"mb-3 col-md-6"},tt=t("label",{for:"price",class:"form-label"},"單位",-1),et={class:"row"},ot={class:"mb-3 col-md-6"},st=t("label",{for:"origin_price",class:"form-label"},"原價",-1),lt={class:"mb-3 col-md-6"},dt=t("label",{for:"price",class:"form-label"},"售價",-1),it=t("hr",null,null,-1),nt={class:"mb-3"},at=t("label",{for:"description",class:"form-label"},"產品描述",-1),ct={class:"mb-3"},rt=t("label",{for:"content",class:"form-label"},"說明內容",-1),ut={class:"mb-3"},mt={class:"form-check"},pt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),ht={class:"modal-footer"},_t=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function bt(l,o,e,U,u,r){return a(),c("div",N,[t("div",D,[t("div",E,[t("div",L,[t("h5",T,[t("span",null,m(e.isNew?"新增":"編輯")+"產品",1)]),A]),t("div",I,[t("div",R,[t("div",H,[t("div",F,[t("div",O,[S,d(t("input",{"onUpdate:modelValue":o[0]||(o[0]=s=>e.tempProduct.imageUrl=s),type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,512),[[n,e.tempProduct.imageUrl]])]),t("img",{class:"img-fluid",src:e.tempProduct.imageUrl,alt:"tempProduct.title"},null,8,$)]),t("div",null,[K,Array.isArray(e.tempProduct.imagesUrl)?(a(),c("div",j,[(a(!0),c(b,null,w(e.tempProduct.imagesUrl,(s,p)=>(a(),c(b,{key:s+"1"},[d(t("input",{type:"text",class:"form-control mt-2 mb-3","onUpdate:modelValue":P=>e.tempProduct.imagesUrl[p]=P},null,8,q),[[n,e.tempProduct.imagesUrl[p]]]),t("img",{src:e.tempProduct.imagesUrl[p],alt:e.tempProduct.title,class:"img-fluid"},null,8,z)],64))),128)),!e.tempProduct.imagesUrl.length||e.tempProduct.imagesUrl[e.tempProduct.imagesUrl.length-1]?(a(),c("button",{key:0,class:"btn btn-outline-primary btn-sm d-block w-100",onClick:o[1]||(o[1]=s=>e.tempProduct.imagesUrl.push("")),type:"button"}," 新增圖片 ")):(a(),c("button",{key:1,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:o[2]||(o[2]=s=>e.tempProduct.imagesUrl.pop())}," 刪除圖片 "))])):x("",!0)])]),t("div",G,[t("div",J,[Q,d(t("input",{id:"title","onUpdate:modelValue":o[3]||(o[3]=s=>e.tempProduct.title=s),type:"text",class:"form-control",placeholder:"請輸入標題"},null,512),[[n,e.tempProduct.title]])]),t("div",W,[t("div",X,[Y,d(t("input",{id:"category","onUpdate:modelValue":o[4]||(o[4]=s=>e.tempProduct.category=s),type:"text",class:"form-control",placeholder:"請輸入分類"},null,512),[[n,e.tempProduct.category]])]),t("div",Z,[tt,d(t("input",{id:"unit","onUpdate:modelValue":o[5]||(o[5]=s=>e.tempProduct.unit=s),type:"text",class:"form-control",placeholder:"請輸入單位"},null,512),[[n,e.tempProduct.unit]])])]),t("div",et,[t("div",ot,[st,d(t("input",{id:"origin_price","onUpdate:modelValue":o[6]||(o[6]=s=>e.tempProduct.origin_price=s),type:"number",min:"0",class:"form-control",placeholder:"請輸入原價"},null,512),[[n,e.tempProduct.origin_price,void 0,{number:!0}]])]),t("div",lt,[dt,d(t("input",{id:"price","onUpdate:modelValue":o[7]||(o[7]=s=>e.tempProduct.price=s),type:"number",min:"0",class:"form-control",placeholder:"請輸入售價"},null,512),[[n,e.tempProduct.price,void 0,{number:!0}]])])]),it,t("div",nt,[at,d(t("textarea",{id:"description","onUpdate:modelValue":o[8]||(o[8]=s=>e.tempProduct.description=s),type:"text",class:"form-control",placeholder:"請輸入產品描述"},`\r
                `,512),[[n,e.tempProduct.description]])]),t("div",ct,[rt,d(t("textarea",{id:"description","onUpdate:modelValue":o[9]||(o[9]=s=>e.tempProduct.content=s),type:"text",class:"form-control",placeholder:"請輸入說明內容"},`\r
                `,512),[[n,e.tempProduct.content]])]),t("div",ut,[t("div",mt,[d(t("input",{id:"is_enabled","onUpdate:modelValue":o[10]||(o[10]=s=>e.tempProduct.is_enabled=s),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[k,e.tempProduct.is_enabled]]),pt])])])])]),t("div",ht,[_t,t("button",{type:"button",class:"btn btn-primary",onClick:o[11]||(o[11]=(...s)=>e.updateProduct&&e.updateProduct(...s))}," 確認 ")])])])])}const Pt=y(B,[["render",bt]]),{VITE_URL:h,VITE_PATH:_}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"kc777",BASE_URL:"/Burger/",MODE:"production",DEV:!1,PROD:!0},gt={data(){return{products:[],tempProduct:{imagesUrl:[]},isNew:!1,pagination:{},deleteModal:"",productModal:""}},components:{productModal:Pt,deleteModal:C,productPagination:V},methods:{getProducts(l=1){const o=`${h}api/${_}/admin/products/?page=${l}`;this.$http.get(o).then(e=>{this.products=e.data.products,this.pagination=e.data.pagination}).catch(e=>{swal.fire({icon:"error",title:`${e.response.data.message}`,showConfirmButton:!1})})},updateProduct(){let l=`${h}api/${_}/admin/product`,o="post";this.isNew||(l=`${h}api/${_}/admin/product/${this.tempProduct.id}`,o="put"),this.$http[o](l,{data:this.tempProduct}).then(()=>{this.getProducts(),this.productModal.hide()}).catch(e=>{this.$swal({title:e.response.data.message,icon:"error",showConfirmButton:!1})})},deleteProduct(){const l=`${h}api/${_}/admin/product/${this.tempProduct.id}`;this.$http.delete(l).then(()=>{this.getProducts(),this.deleteModal.hide(),this.$swal({title:"刪除成功！",icon:"success",showConfirmButton:!1})}).catch(o=>{this.$swal({title:o.response.data.message,icon:"error",showConfirmButton:!1})})},openModal(l,o){l==="add"?(this.productModal.show(),this.isNew=!0,this.tempProduct={imagesUrl:[]}):l==="edit"?(this.productModal.show(),this.isNew=!1,this.tempProduct={...o}):l==="del"&&(this.deleteModal.show(),this.tempProduct={...o})}},mounted(){this.getProducts(),this.productModal=new v("#productModal"),this.deleteModal=new v("#deleteModal")}},ft={id:"main",class:"container"},vt={class:"text-end mt-4"},yt={class:"table mt-4"},wt=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"120"},"編輯")])],-1),Ut={class:"badge bg-secondary"},Mt={class:"text-start"},xt={class:"text-start"},kt={class:"text-success"},Ct={class:"btn-group"},Vt=["onClick"],Bt=["onClick"],Nt={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},Dt={id:"deleteModal",ref:"deleteModal",class:"modal fade",tabindex:"-1","aria-labelledby":"deleteModalLabel","aria-hidden":"true"};function Et(l,o,e,U,u,r){const s=g("productPagination"),p=g("product-modal"),P=g("delete-modal");return a(),c(b,null,[t("div",ft,[t("div",vt,[t("button",{type:"button",class:"btn btn-primary",onClick:o[0]||(o[0]=i=>r.openModal("add"))}," 建立新的產品 ")]),t("table",yt,[wt,(a(!0),c(b,null,w(u.products,i=>(a(),c("tbody",{key:i.id},[t("tr",null,[t("td",null,[t("span",Ut,m(i.category),1)]),t("td",null,m(i.title),1),t("td",Mt,m(i.origin_price),1),t("td",xt,m(i.price),1),t("td",null,[t("span",kt,m(i.is_enabled?"啟用":"未啟用"),1)]),t("td",null,[t("div",Ct,[t("button",{type:"button",id:"editBtn",class:"btn btn-outline-secondary btn-sm",onClick:M=>r.openModal("edit",i)}," 編輯 ",8,Vt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:M=>r.openModal("del",i)}," 刪除 ",8,Bt)])])])]))),128))]),f(s,{pages:u.pagination,onChangePage:r.getProducts},null,8,["pages","onChangePage"])]),t("div",Nt,[f(p,{"temp-product":u.tempProduct,"is-new":u.isNew,onUpdateProduct:r.updateProduct},null,8,["temp-product","is-new","onUpdateProduct"])],512),t("div",Dt,[f(P,{"temp-product":u.tempProduct,onDeleteProduct:r.deleteProduct},null,8,["temp-product","onDeleteProduct"])],512)],64)}const At=y(gt,[["render",Et]]);export{At as default};
